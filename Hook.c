/*********************************************************
 * ファイル名 : Hook.c
 * 責務       : システムフック
 * 作成日     : 2012.11.27
 * 作成者     : BackSLASH DESIGN Co.,Ltd
 * 修正日     : yyyy.mm.dd : Name : reason
 * 備考       :
 *********************************************************/

/**********************************************************
 * 自ヘッダ#include
 *********************************************************/
#include "Hook.h"
/**********************************************************
 * システムヘッダ#include
 *********************************************************/
#include "kernel.h"
#include "kernel_id.h"
#include "ecrobot_interface.h"
/**********************************************************
 * ユーザ作成ヘッダ#include
 *********************************************************/
#include "Robot.h"
#include "Running.h"
/**********************************************************
 * #define
 *********************************************************/
/**********************************************************
 * typedef
 *********************************************************/
/**********************************************************
 * enum
 *********************************************************/
/**********************************************************
 * struct/union
 *********************************************************/
/**********************************************************
 * 変数
 *********************************************************/
/**********************************************************
 * タスク
 *********************************************************/
DeclareCounter(SysTimerCnt);

/**********************************************************
 * 関数
 *********************************************************/
void ecrobot_device_initialize(void);
void ecrobot_device_terminate(void);
void user_1ms_isr_type2(void);

/**********************************************************
 * 関数名 ： ecrobot_device_initialize
 * 機能　 ： 各センサ初期化処理
 * 引数　 ： なし
 * 戻値　 ： なし
 * 備考　 ： 実行画面切替時に実行
 *********************************************************/
void ecrobot_device_initialize(void)
{
  rb_init();
  rn_init();
  return;
}
/**********************************************************
 * 関数名 ： ecrobot_device_terminate
 * 機能　 ： 各センサ終了処理
 * 引数　 ： なし
 * 戻値　 ： なし
 * 備考　 ： プログラム動作中にBACK,LEFTボタン押下時実行
 *********************************************************/
void ecrobot_device_terminate(void)
{
  rn_term();
  rb_term();
  return;
}
/**********************************************************
 * 関数名 ： user_1ms_isr_type2
 * 機能　 ： カウンター更新, エラー時終了
 * 引数　 ： 無
 * 戻値　 ： 無
 * 備考　 ： 1msec周期で割り込みを行う
 *********************************************************/
void user_1ms_isr_type2(void)
{
  static StatusType ercd;
  ercd = SignalCounter(SysTimerCnt);
  if (ercd != E_OK)
    {
      ShutdownOS(ercd);
    }
  return;
}
